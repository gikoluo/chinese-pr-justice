---
// Calling For / Demands Section
import { demandsSection, demandTitles, demandBodies } from '../i18n/strings';
---

<section id="demands" class="demands-section">
    <div class="container">
        <h2><span class="lang-en">{demandsSection.title.en}</span><span class="lang-zh">{demandsSection.title.zh}</span><span class="lang-fr">{demandsSection.title.fr}</span></h2>
        <p class="section-intro"><span class="lang-en">{demandsSection.intro.en}</span><span class="lang-zh">{demandsSection.intro.zh}</span><span class="lang-fr">{demandsSection.intro.fr}</span></p>

        <div class="demands-grid">
            <div class="demand-card">
                <div class="demand-number">1</div>
                <h3><span class="lang-en">{demandTitles.immediate.en}</span><span class="lang-zh">{demandTitles.immediate.zh}</span><span class="lang-fr">{demandTitles.immediate.fr}</span></h3>
                <p class="demand-card-text"><span class="lang-en">{demandBodies.immediate.en}</span><span class="lang-zh">{demandBodies.immediate.zh}</span><span class="lang-fr">{demandBodies.immediate.fr}</span></p>
                <div class="demand-expand-wrap" style="display: none;">
                    <button type="button" class="demand-expand-btn" aria-expanded="false">
                        <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                        <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                    </button>
                </div>
            </div>

            <div class="demand-card">
                <div class="demand-number">2</div>
                <h3><span class="lang-en">{demandTitles.equal.en}</span><span class="lang-zh">{demandTitles.equal.zh}</span><span class="lang-fr">{demandTitles.equal.fr}</span></h3>
                <p class="demand-card-text"><span class="lang-en">{demandBodies.equal.en}</span><span class="lang-zh">{demandBodies.equal.zh}</span><span class="lang-fr">{demandBodies.equal.fr}</span></p>
                <div class="demand-expand-wrap" style="display: none;">
                    <button type="button" class="demand-expand-btn" aria-expanded="false">
                        <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                        <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                    </button>
                </div>
            </div>

            <div class="demand-card">
                <div class="demand-number">3</div>
                <h3><span class="lang-en">{demandTitles.transparency.en}</span><span class="lang-zh">{demandTitles.transparency.zh}</span><span class="lang-fr">{demandTitles.transparency.fr}</span></h3>
                <p class="demand-card-text"><span class="lang-en">{demandBodies.transparency.en}</span><span class="lang-zh">{demandBodies.transparency.zh}</span><span class="lang-fr">{demandBodies.transparency.fr}</span></p>
                <div class="demand-expand-wrap" style="display: none;">
                    <button type="button" class="demand-expand-btn" aria-expanded="false">
                        <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                        <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                    </button>
                </div>
            </div>

            <div class="demand-card">
                <div class="demand-number">4</div>
                <h3><span class="lang-en">{demandTitles.accountability.en}</span><span class="lang-zh">{demandTitles.accountability.zh}</span><span class="lang-fr">{demandTitles.accountability.fr}</span></h3>
                <p class="demand-card-text"><span class="lang-en">{demandBodies.accountability.en}</span><span class="lang-zh">{demandBodies.accountability.zh}</span><span class="lang-fr">{demandBodies.accountability.fr}</span></p>
                <div class="demand-expand-wrap" style="display: none;">
                    <button type="button" class="demand-expand-btn" aria-expanded="false">
                        <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                        <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                    </button>
                </div>
            </div>

            <div class="demand-card">
                <div class="demand-number">5</div>
                <h3><span class="lang-en">{demandTitles.humanitarian.en}</span><span class="lang-zh">{demandTitles.humanitarian.zh}</span><span class="lang-fr">{demandTitles.humanitarian.fr}</span></h3>
                <p class="demand-card-text"><span class="lang-en">{demandBodies.humanitarian.en}</span><span class="lang-zh">{demandBodies.humanitarian.zh}</span><span class="lang-fr">{demandBodies.humanitarian.fr}</span></p>
                <div class="demand-expand-wrap" style="display: none;">
                    <button type="button" class="demand-expand-btn" aria-expanded="false">
                        <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                        <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                    </button>
                </div>
            </div>

            <div class="demand-card">
                <div class="demand-number">6</div>
                <h3><span class="lang-en">{demandTitles.temporary.en}</span><span class="lang-zh">{demandTitles.temporary.zh}</span><span class="lang-fr">{demandTitles.temporary.fr}</span></h3>
                <p class="demand-card-text"><span class="lang-en">{demandBodies.temporary.en}</span><span class="lang-zh">{demandBodies.temporary.zh}</span><span class="lang-fr">{demandBodies.temporary.fr}</span></p>
                <div class="demand-expand-wrap" style="display: none;">
                    <button type="button" class="demand-expand-btn" aria-expanded="false">
                        <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                        <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                    </button>
                </div>
            </div>

            <div class="demand-card">
                <div class="demand-number">7</div>
                <h3><span class="lang-en">{demandTitles.mandamus.en}</span><span class="lang-zh">{demandTitles.mandamus.zh}</span><span class="lang-fr">{demandTitles.mandamus.fr}</span></h3>
                <p class="demand-card-text"><span class="lang-en">{demandBodies.mandamus.en}</span><span class="lang-zh">{demandBodies.mandamus.zh}</span><span class="lang-fr">{demandBodies.mandamus.fr}</span></p>
                <div class="demand-expand-wrap" style="display: none;">
                    <button type="button" class="demand-expand-btn" aria-expanded="false">
                        <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                        <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                    </button>
                </div>
            </div>

            <div class="demand-card">
                <div class="demand-number">8</div>
                <h3><span class="lang-en">{demandTitles.apology.en}</span><span class="lang-zh">{demandTitles.apology.zh}</span><span class="lang-fr">{demandTitles.apology.fr}</span></h3>
                <p class="demand-card-text"><span class="lang-en">{demandBodies.apology.en}</span><span class="lang-zh">{demandBodies.apology.zh}</span><span class="lang-fr">{demandBodies.apology.fr}</span></p>
                <div class="demand-expand-wrap" style="display: none;">
                    <button type="button" class="demand-expand-btn" aria-expanded="false">
                        <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                        <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                    </button>
                </div>
            </div>
        </div>

        <div class="demands-cta">
            <h3><span class="lang-en">{demandsSection.supportTitle.en}</span><span class="lang-zh">{demandsSection.supportTitle.zh}</span><span class="lang-fr">{demandsSection.supportTitle.fr}</span></h3>
            <p><span class="lang-en">{demandsSection.supportDesc.en}</span><span class="lang-zh">{demandsSection.supportDesc.zh}</span><span class="lang-fr">{demandsSection.supportDesc.fr}</span></p>
            <a href="/join" class="btn-cta btn-flip">
                <span class="btn-text-block">
                    <span class="btn-text-wrapper">
                        <span class="hover-out-text"><span class="lang-en">{demandsSection.joinMovement.en}</span><span class="lang-zh">{demandsSection.joinMovement.zh}</span><span class="lang-fr">{demandsSection.joinMovement.fr}</span></span>
                        <span class="hover-in-text"><span class="lang-en">{demandsSection.joinMovement.en}</span><span class="lang-zh">{demandsSection.joinMovement.zh}</span><span class="lang-fr">{demandsSection.joinMovement.fr}</span></span>
                    </span>
                </span>
            </a>
        </div>
    </div>
</section>

<script>
    (function initDemandExpand() {
        function checkDemandCards() {
            document.querySelectorAll('.demand-card').forEach(function (card) {
                var p = card.querySelector('.demand-card-text');
                var wrap = card.querySelector('.demand-expand-wrap');
                var btn = card.querySelector('.demand-expand-btn');
                if (!p || !wrap || !btn) return;
                var truncated = p.scrollHeight > p.clientHeight + 2;
                if (truncated) {
                    wrap.style.display = '';
                    btn.addEventListener('click', function toggleExpand() {
                        var expanded = card.classList.toggle('demand-card--expanded');
                        btn.setAttribute('aria-expanded', String(expanded));
                        var expandLabel = btn.querySelector('.demand-btn-expand');
                        var collapseLabel = btn.querySelector('.demand-btn-collapse');
                        if (expandLabel && collapseLabel) {
                            expandLabel.style.display = expanded ? 'none' : '';
                            collapseLabel.style.display = expanded ? '' : 'none';
                        }
                    }, { once: false });
                }
            });
        }
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', checkDemandCards);
        } else {
            checkDemandCards();
        }
    })();
</script>

<style>
    /* CTA Button with Flip Animation */
    .btn-cta {
        background: rgb(229, 25, 55);
        color: #ffffff;
        padding: 0.875rem 1.5rem;
        font-size: 0.9375rem;
        font-weight: 500;
        letter-spacing: 0.5px;
        border-radius: 4px;
        transition: background 0.2s;
    }

    .btn-cta:hover {
        background: rgb(200, 20, 45);
    }

    /* Flip animation */
    .btn-flip {
        display: inline-block;
        text-decoration: none;
    }

    .btn-text-block {
        display: block;
        overflow: hidden;
        height: 1.25em;
    }

    .btn-text-wrapper {
        display: block;
        transition: transform 0.3s ease;
    }

    .hover-out-text,
    .hover-in-text {
        display: block;
        height: 1.25em;
        line-height: 1.25;
    }

    .btn-flip:hover .btn-text-wrapper {
        transform: translateY(-50%);
    }
</style>
