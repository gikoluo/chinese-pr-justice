---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import OurStories from '../components/OurStories.astro';
import EventPhotos from '../components/EventPhotos.astro';
import CitationText from '../components/CitationText.astro';
import { declarationSection, declarationWhereasKeys, demandsSection, demandTitles, demandBodies } from '../i18n/strings';
---

<BaseLayout title="Justice for Chinese PR Applicants - End Unfair Security Screening Delays">
    <Hero />

    <!-- Justice Declaration Section (petition-exact: WHEREAS + CONCLUSION) -->
    <section id="declaration" class="declaration-section">
        <div class="container">
            <h2><span class="lang-en">{declarationSection.title.en}</span><span class="lang-zh">{declarationSection.title.zh}</span><span class="lang-fr">{declarationSection.title.fr}</span></h2>
            <div class="declaration-content">
                <div class="declaration-intro">
                    <h3><span class="lang-en">{declarationSection.introTitle.en}</span><span class="lang-zh">{declarationSection.introTitle.zh}</span><span class="lang-fr">{declarationSection.introTitle.fr}</span></h3>
                    <p class="declaration-to-whom">
                        <span class="lang-en">{declarationSection.introParagraph.en}</span>
                        <span class="lang-zh">{declarationSection.introParagraph.zh}</span>
                        <span class="lang-fr">{declarationSection.introParagraph.fr}</span>
                    </p>
                </div>
                <h3 class="declaration-subtitle"><span class="lang-en">{declarationSection.whereasTitle.en}</span><span class="lang-zh">{declarationSection.whereasTitle.zh}</span><span class="lang-fr">{declarationSection.whereasTitle.fr}</span></h3>
                <ul class="declaration-list declaration-whereas-grid">
                    {declarationWhereasKeys.map((key) => (
                        <li>
                            <span class="whereas-topic lang-en">{declarationSection.whereasTopic[key].en}:</span>
                            <span class="whereas-topic lang-zh">{declarationSection.whereasTopic[key].zh}ï¼š</span>
                            <span class="whereas-topic lang-fr">{declarationSection.whereasTopic[key].fr} :</span>
                            <span class="lang-en"><CitationText text={declarationSection[key].en} /></span>
                            <span class="lang-zh"><CitationText text={declarationSection[key].zh} /></span>
                            <span class="lang-fr"><CitationText text={declarationSection[key].fr} /></span>
                        </li>
                    ))}
                </ul>
                <h3 class="declaration-subtitle declaration-conclusion-heading"><span class="lang-en">{declarationSection.conclusionTitle.en}</span><span class="lang-zh">{declarationSection.conclusionTitle.zh}</span><span class="lang-fr">{declarationSection.conclusionTitle.fr}</span></h3>
                <ul class="declaration-list conclusion-list">
                    <li><span class="lang-en"><CitationText text={declarationSection.conclusion1.en} /></span><span class="lang-zh"><CitationText text={declarationSection.conclusion1.zh} /></span><span class="lang-fr"><CitationText text={declarationSection.conclusion1.fr} /></span></li>
                    <li><span class="lang-en"><CitationText text={declarationSection.conclusion2.en} /></span><span class="lang-zh"><CitationText text={declarationSection.conclusion2.zh} /></span><span class="lang-fr"><CitationText text={declarationSection.conclusion2.fr} /></span></li>
                    <li><span class="lang-en"><CitationText text={declarationSection.conclusion3.en} /></span><span class="lang-zh"><CitationText text={declarationSection.conclusion3.zh} /></span><span class="lang-fr"><CitationText text={declarationSection.conclusion3.fr} /></span></li>
                    <li><span class="lang-en"><CitationText text={declarationSection.conclusion4.en} /></span><span class="lang-zh"><CitationText text={declarationSection.conclusion4.zh} /></span><span class="lang-fr"><CitationText text={declarationSection.conclusion4.fr} /></span></li>
                </ul>
                <p class="declaration-conclusion"><span class="lang-en"><CitationText text={declarationSection.conclusionFinal.en} /></span><span class="lang-zh"><CitationText text={declarationSection.conclusionFinal.zh} /></span><span class="lang-fr"><CitationText text={declarationSection.conclusionFinal.fr} /></span></p>
            </div>
        </div>
    </section>

    <!-- Calling For / Demands Section -->
    <section id="demands" class="demands-section">
        <div class="container">
            <h2><span class="lang-en">{demandsSection.title.en}</span><span class="lang-zh">{demandsSection.title.zh}</span><span class="lang-fr">{demandsSection.title.fr}</span></h2>
            <p class="section-intro"><span class="lang-en">{demandsSection.intro.en}</span><span class="lang-zh">{demandsSection.intro.zh}</span><span class="lang-fr">{demandsSection.intro.fr}</span></p>

            <div class="demands-grid">
                <div class="demand-card">
                    <div class="demand-number">1</div>
                    <h3><span class="lang-en">{demandTitles.immediate.en}</span><span class="lang-zh">{demandTitles.immediate.zh}</span><span class="lang-fr">{demandTitles.immediate.fr}</span></h3>
                    <p class="demand-card-text"><span class="lang-en">{demandBodies.immediate.en}</span><span class="lang-zh">{demandBodies.immediate.zh}</span><span class="lang-fr">{demandBodies.immediate.fr}</span></p>
                    <div class="demand-expand-wrap" style="display: none;">
                        <button type="button" class="demand-expand-btn" aria-expanded="false">
                            <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                            <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                        </button>
                    </div>
                </div>

                <div class="demand-card">
                    <div class="demand-number">2</div>
                    <h3><span class="lang-en">{demandTitles.equal.en}</span><span class="lang-zh">{demandTitles.equal.zh}</span><span class="lang-fr">{demandTitles.equal.fr}</span></h3>
                    <p class="demand-card-text"><span class="lang-en">{demandBodies.equal.en}</span><span class="lang-zh">{demandBodies.equal.zh}</span><span class="lang-fr">{demandBodies.equal.fr}</span></p>
                    <div class="demand-expand-wrap" style="display: none;">
                        <button type="button" class="demand-expand-btn" aria-expanded="false">
                            <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                            <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                        </button>
                    </div>
                </div>

                <div class="demand-card">
                    <div class="demand-number">3</div>
                    <h3><span class="lang-en">{demandTitles.transparency.en}</span><span class="lang-zh">{demandTitles.transparency.zh}</span><span class="lang-fr">{demandTitles.transparency.fr}</span></h3>
                    <p class="demand-card-text"><span class="lang-en">{demandBodies.transparency.en}</span><span class="lang-zh">{demandBodies.transparency.zh}</span><span class="lang-fr">{demandBodies.transparency.fr}</span></p>
                    <div class="demand-expand-wrap" style="display: none;">
                        <button type="button" class="demand-expand-btn" aria-expanded="false">
                            <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                            <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                        </button>
                    </div>
                </div>

                <div class="demand-card">
                    <div class="demand-number">4</div>
                    <h3><span class="lang-en">{demandTitles.accountability.en}</span><span class="lang-zh">{demandTitles.accountability.zh}</span><span class="lang-fr">{demandTitles.accountability.fr}</span></h3>
                    <p class="demand-card-text"><span class="lang-en">{demandBodies.accountability.en}</span><span class="lang-zh">{demandBodies.accountability.zh}</span><span class="lang-fr">{demandBodies.accountability.fr}</span></p>
                    <div class="demand-expand-wrap" style="display: none;">
                        <button type="button" class="demand-expand-btn" aria-expanded="false">
                            <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                            <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                        </button>
                    </div>
                </div>

                <div class="demand-card">
                    <div class="demand-number">5</div>
                    <h3><span class="lang-en">{demandTitles.humanitarian.en}</span><span class="lang-zh">{demandTitles.humanitarian.zh}</span><span class="lang-fr">{demandTitles.humanitarian.fr}</span></h3>
                    <p class="demand-card-text"><span class="lang-en">{demandBodies.humanitarian.en}</span><span class="lang-zh">{demandBodies.humanitarian.zh}</span><span class="lang-fr">{demandBodies.humanitarian.fr}</span></p>
                    <div class="demand-expand-wrap" style="display: none;">
                        <button type="button" class="demand-expand-btn" aria-expanded="false">
                            <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                            <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                        </button>
                    </div>
                </div>

                <div class="demand-card">
                    <div class="demand-number">6</div>
                    <h3><span class="lang-en">{demandTitles.temporary.en}</span><span class="lang-zh">{demandTitles.temporary.zh}</span><span class="lang-fr">{demandTitles.temporary.fr}</span></h3>
                    <p class="demand-card-text"><span class="lang-en">{demandBodies.temporary.en}</span><span class="lang-zh">{demandBodies.temporary.zh}</span><span class="lang-fr">{demandBodies.temporary.fr}</span></p>
                    <div class="demand-expand-wrap" style="display: none;">
                        <button type="button" class="demand-expand-btn" aria-expanded="false">
                            <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                            <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                        </button>
                    </div>
                </div>

                <div class="demand-card">
                    <div class="demand-number">7</div>
                    <h3><span class="lang-en">{demandTitles.mandamus.en}</span><span class="lang-zh">{demandTitles.mandamus.zh}</span><span class="lang-fr">{demandTitles.mandamus.fr}</span></h3>
                    <p class="demand-card-text"><span class="lang-en">{demandBodies.mandamus.en}</span><span class="lang-zh">{demandBodies.mandamus.zh}</span><span class="lang-fr">{demandBodies.mandamus.fr}</span></p>
                    <div class="demand-expand-wrap" style="display: none;">
                        <button type="button" class="demand-expand-btn" aria-expanded="false">
                            <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                            <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                        </button>
                    </div>
                </div>

                <div class="demand-card">
                    <div class="demand-number">8</div>
                    <h3><span class="lang-en">{demandTitles.apology.en}</span><span class="lang-zh">{demandTitles.apology.zh}</span><span class="lang-fr">{demandTitles.apology.fr}</span></h3>
                    <p class="demand-card-text"><span class="lang-en">{demandBodies.apology.en}</span><span class="lang-zh">{demandBodies.apology.zh}</span><span class="lang-fr">{demandBodies.apology.fr}</span></p>
                    <div class="demand-expand-wrap" style="display: none;">
                        <button type="button" class="demand-expand-btn" aria-expanded="false">
                            <span class="demand-btn-expand"><span class="lang-en">{demandsSection.expand.en}</span><span class="lang-zh">{demandsSection.expand.zh}</span><span class="lang-fr">{demandsSection.expand.fr}</span></span>
                            <span class="demand-btn-collapse" style="display: none;"><span class="lang-en">{demandsSection.collapse.en}</span><span class="lang-zh">{demandsSection.collapse.zh}</span><span class="lang-fr">{demandsSection.collapse.fr}</span></span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="demands-cta">
                <h3><span class="lang-en">{demandsSection.supportTitle.en}</span><span class="lang-zh">{demandsSection.supportTitle.zh}</span><span class="lang-fr">{demandsSection.supportTitle.fr}</span></h3>
                <p><span class="lang-en">{demandsSection.supportDesc.en}</span><span class="lang-zh">{demandsSection.supportDesc.zh}</span><span class="lang-fr">{demandsSection.supportDesc.fr}</span></p>
                <a href="/join" class="btn btn-primary-large"><span class="lang-en">{demandsSection.joinMovement.en}</span><span class="lang-zh">{demandsSection.joinMovement.zh}</span><span class="lang-fr">{demandsSection.joinMovement.fr}</span></a>
            </div>
        </div>
    </section>

    <OurStories />

    <EventPhotos showNote={true} />

    <script>
        (function initDemandExpand() {
            function checkDemandCards() {
                document.querySelectorAll('.demand-card').forEach(function (card) {
                    var p = card.querySelector('.demand-card-text');
                    var wrap = card.querySelector('.demand-expand-wrap');
                    var btn = card.querySelector('.demand-expand-btn');
                    if (!p || !wrap || !btn) return;
                    var truncated = p.scrollHeight > p.clientHeight + 2;
                    if (truncated) {
                        wrap.style.display = '';
                        btn.addEventListener('click', function toggleExpand() {
                            var expanded = card.classList.toggle('demand-card--expanded');
                            btn.setAttribute('aria-expanded', String(expanded));
                            var expandLabel = btn.querySelector('.demand-btn-expand');
                            var collapseLabel = btn.querySelector('.demand-btn-collapse');
                            if (expandLabel && collapseLabel) {
                                expandLabel.style.display = expanded ? 'none' : '';
                                collapseLabel.style.display = expanded ? '' : 'none';
                            }
                        }, { once: false });
                    }
                });
            }
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', checkDemandCards);
            } else {
                checkDemandCards();
            }
        })();
    </script>
</BaseLayout>
